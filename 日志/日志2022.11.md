## 摘要



## 前言

大背景，我要做的事很重要

目前这个任务的国内外的做法，他们的方法在我要做的这件事情上有什么缺点。

我的方法通过...能够克服以上缺点，并不降低某种效果，有什么样的优势

## 相关工作

讲一下现有的方法、任务

## 所提方法

分2~3个点来讲讲(总-分-分/分-分-总)

## 实验验证

方法是可行的，有哪些优点，有哪些评判指标

对比试验、消融实验

## 总结

讲一下背景，我提出的方法解决了什么问题，

在实验上，在指标上....

前瞻性，我们的工作是有原因的，本文的不足，还可以开展进一步工作





------

## 开源代码

**Lidar-IMU-Localization**：https://github.com/chengwei0427/Lidar_IMU_Localization





https://github.com/ZhuangYanDLUT/lidar_gnss_mapping

![image-20221010211914358](https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/10/upgit_20221010_1665407955.png)

https://github.com/ZhuangYanDLUT/hard_sync_dut

![image-20221010211930975](https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/10/upgit_20221010_1665407971.png)





https://github.com/uos/mesh_navigation

![image-20221120211143713](https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/11/upgit_20221120_1668949903.png)

https://github.com/jdgalviss/autonomous_mobile_robot

![image-20221120210757034](https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/11/upgit_20221120_1668949678.png)





https://www.bilibili.com/video/BV1fV4y1M76b/

satellites插件

rviz satellites https://github.com/nobleo/rviz_satellite



UrbanLoco Dataset

Thanks for requiring for the dataset, you can download the dataset through the link here:

HK Data:
HK-Data20190316-1： [https://drive.google.com/file/d/1p8c8oHXPGIkhe-7RPtxs5KqV_QgjpWgf/view?usp=sharing](https://www.google.com/url?q=https://drive.google.com/file/d/1p8c8oHXPGIkhe-7RPtxs5KqV_QgjpWgf/view?usp%3Dsharing&sa=D&source=editors&ust=1666154370807264&usg=AOvVaw3wbMocBVOU2boP0H4DvuuU)
HK-Data20190117： [https://drive.google.com/open?id=17JQNs8_Mf2t4nvLUsF76AD6fxaTbZdFg](https://www.google.com/url?q=https://drive.google.com/open?id%3D17JQNs8_Mf2t4nvLUsF76AD6fxaTbZdFg&sa=D&source=editors&ust=1666154370807435&usg=AOvVaw3pT3gXA0bcQTNqvNDQsKDI)
HK-Data20190317： [https://drive.google.com/open?id=1LsHpkufrzlUIMtE-OBr55UEPSmgrMfes](https://www.google.com/url?q=https://drive.google.com/open?id%3D1LsHpkufrzlUIMtE-OBr55UEPSmgrMfes&sa=D&source=editors&ust=1666154370807524&usg=AOvVaw1rM32LYm17sUDW0970SI6Y)
HK-Data20190316-2： [https://drive.google.com/file/d/1bxLi5o2DQPlmcwnsm4Tq4Dxo494GcviB/view?usp=sharing](https://www.google.com/url?q=https://drive.google.com/file/d/1bxLi5o2DQPlmcwnsm4Tq4Dxo494GcviB/view?usp%3Dsharing&sa=D&source=editors&ust=1666154370807632&usg=AOvVaw0EFpBFp03QdZiwR_OOi3sQ)
HK-Data20190426-1：[https://drive.google.com/file/d/1RHerkS35NdzBkWXNjF8z8wUPLLAraFnF/view?usp=sharing](https://www.google.com/url?q=https://drive.google.com/file/d/1RHerkS35NdzBkWXNjF8z8wUPLLAraFnF/view?usp%3Dsharing&sa=D&source=editors&ust=1666154370807729&usg=AOvVaw0sh2qcH1SdqiHkWoK-hYe7)
HK-Data20190426-2：[https://drive.google.com/file/d/1iJsGva7R_sDtobmbZex6M7s05dBcg24h/view?usp=sharing](https://www.google.com/url?q=https://drive.google.com/file/d/1iJsGva7R_sDtobmbZex6M7s05dBcg24h/view?usp%3Dsharing&sa=D&source=editors&ust=1666154370807834&usg=AOvVaw04OfGiNntGRy547Xw2N7tQ)


CA: [https://drive.google.com/drive/folders/121qGshjIAAgGuKmm3uYHv3SwXey7lXd3?usp=sharing](https://www.google.com/url?q=https://drive.google.com/drive/folders/121qGshjIAAgGuKmm3uYHv3SwXey7lXd3?usp%3Dsharing&sa=D&source=editors&ust=1666154370807939&usg=AOvVaw2mmkrWqh-jYLhAwgP9YKDP) 



## 高德api

![image-20221020092328032](https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/10/upgit_20221020_1666229008.png)

![image-20221020092351762](https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/10/upgit_20221020_1666229031.png)

## DWA算法

https://charon-cheung.github.io/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/DWA%E7%AE%97%E6%B3%95/

https://github.com/amslabtech/dwa_planner

https://github.com/BlackTea12/RL-DWA



https://github.com/jdgalviss/autonomous_mobile_robot
$$
X=\left(
\begin{array}{c}
 x \\
 y \\
 \text{yaw} \\
 v \\
 \omega  \\
\end{array}
\right)
$$





$$
X= \left(
\begin{array}{ccccc}
 1 & 0 & 0 & 0 & 0 \\
 0 & 1 & 0 & 0 & 0 \\
 0 & 0 & 1 & 0 & 0 \\
 0 & 0 & 0 & 0 & 0 \\
 0 & 0 & 0 & 0 & 0 \\
\end{array}
\right)
X+
 \left(
\begin{array}{cc}
 dt \cos{\alpha} & 0 \\
 dt \sin{\alpha} & 0 \\
 0 & \text{dt} \\
 1 & 0 \\
 0 & 1 \\
\end{array}
\right)
\left(
\begin{array}{c}
 v \\
 \omega  \\
\end{array}
\right)
$$






| CollisionCheckdreal                                      |                                                              |
| -------------------------------------------------------- | ------------------------------------------------------------ |
| dwa                                                      | <img src="https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/10/upgit_20221028_1666922186.png" alt="image-20221028095626123" style="zoom: 50%;" /> |
| DWA                                                      | <img src="https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/10/upgit_20221028_1666922288.png" alt="image-20221028095808072" style="zoom:50%;" /> |
| dwa.py                                                   | <img src="https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/10/upgit_20221028_1666922342.png" alt="image-20221028095902086" style="zoom:50%;" /> |
| DWA-Simulation                                           | <img src="https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/10/upgit_20221028_1666922425.png" alt="image-20221028100024979" style="zoom: 33%;" /> |
| dynamic_functional_connectivity_analysis                 |                                                              |
| dynamic_window_approach                                  |                                                              |
| DynamicWindowApproach                                    | ![image-20221028101836012](https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/10/upgit_20221028_1666923516.png) |
| DynamicWindowApproach01                                  | ![image-20221028102133270](https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/10/upgit_20221028_1666923693.png) |
| I214（带ros仿真）                                        | ![image-20221028102435767](https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/10/upgit_20221028_1666923875.png) |
| LearnRoboticsCpp                                         |                                                              |
| Path-planning                                            | ![image-20221028104009384](https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/10/upgit_20221028_1666924809.png) |
| Robotics-Dynamic-Window-Approach                         | ![image-20221028103435161](https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/10/upgit_20221028_1666924475.png) |
| ~/work/PythonRobotics/PathPlanning/DynamicWindowApproach | ![image-20221028104658862](https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/10/upgit_20221028_1666925218.png) |



## 论文

差速模型车的微分方程描述(不太适合快速情况)：
$$
\begin{equation*}(x,\ y,\dot{\theta},\ v,\dot{\omega})=( v\cos\theta, vsin \theta, \omega, a_{v}, a_{\omega}). \tag{1}\end{equation*}
$$


DWA的经典版本对线速度和角速度进行采样$(v,\omega)$，描述为圆弧的控制：
$$
\begin{equation*}\mathbf { s } _ { u } ( v, \omega, t ) = \mathbf { s } _ { u _ { 0 } } + \begin{pmatrix} { \frac { v } { \omega } ( \sin ( \theta + \omega t ) - \sin ( \theta ) ) } \\ { \frac { v } { \omega } ( \cos ( \theta + \omega t ) - \cos ( \theta ) ) } \\ { \omega t } \\ { 0 } \\ { 0 } \end{pmatrix}, \tag{2}\end{equation*}
$$


速度、角速度按间隔划分：
$$
\begin{equation*}C=\left\{(a_{v_{i}},\ a_{\omega_{j}})|i,\ j\in\{0,\ N-1\}, \\ a_{v_{i}}\ =-A+i\frac{2A}{N-1}, \\ a_{\omega_{j}}\ =-B+j\frac{2B}{N-1}\right\}, \tag{3}\end{equation*}
$$
$A$ 是最大加速度，$B$ 是最大角加速度，$N$ 是划分数（样本数）



速度的集合：
$$
\begin{equation*}C'=\{(v_{i},\ \omega_{j})|i,\ j\in\{0,\ N-1\}, \\ v_{i}=v_{0}+\delta a_{v_{i}}T, \\ \omega_{j}=\omega_{0}+\delta a_{\omega_{j}}T\}, \tag{4}\end{equation*}
$$
$(v_0,\omega_0)$是机器人当前速度，$T$是DWA算法的一个预测实践范围，$\delta$是离散调整参数，这决定了$[v_0,v_T]$、$[\omega_0,\omega_T]$的采样速度范围。

用目标函数$F$筛选出最优的$(v_k,\omega_l)$，然关联指定的加速度$(a_{vk},a_{\omega l})$，


$$
\begin{equation*}F ( v, \omega )= \alpha \operatorname { gridclearance } ( v, \omega ) \\ + \beta \text { polygonclearance } ( v, \omega ) \\ + \beta \operatorname { progress } ( v, \omega ). \tag{5}\end{equation*}
$$
网格间隙$ { gridclearance } ( v, \omega )$表示机器人到静态障碍物的接近度，在$[0,T]$的时间内评估静态障碍物，返回$[0,1]$之间的模糊占用值。
$$
\begin{equation*}gridclearance (\mathrm{v},\ \omega) =-\max\{\mathrm{g}\mathrm{r}\mathrm{i}\mathrm{d}(\mathrm{s}_{u}(v,\ \omega,\ t_{k}))| \\ k\in\{1,\ \cdots,\ K\},\ t_{k}=k\frac{T}{K}\} \tag{6}\end{equation*}
$$
多边形间隙函数${ polygonclearance } ( v, \omega )$返回未来与移动障碍物第一次的碰撞时间，范围是$t_c\in [0,T]$，归一化后的范围是$[0,1]$。

速度指示器${ progress } ( v, \omega )$计算模拟路径的终点与目标点之间归一化的欧式距离，范围是$[0,1]$
$$
\begin{equation*}(v,\ \omega)=1-\frac{|\mathrm{s}_{u}(v,\omega,T)-g|}{\arg\max_{(v_{i},\omega_{j})\in C'}|\mathrm{s}_{u}(v_{i},\omega_{j},T)-g|} \tag{7}\end{equation*}
$$
目标函数$F$的每一个分量都是归一化的值，在$[0,1]$之间，使用参数$\alpha,\beta,\gamma$分别就行加权。



局部最小值问题





不仅仅从机器人的当前位置生成路径，也从机器人的周围路径生成位置，在计算总成本时加上指向相邻位置的代价。



动态物体的膨胀半径应该时不均匀的



在距离障碍物近的情况下与A*算法结合



问题1：DWA在动态障碍物环境中容易陷入局部最优值，当遇到动态障碍物，且障碍物速度与机器人速度一致时，可能会出现跟随的情况

- ~~不仅仅从机器人的当前位置生成路径，也从机器人的周围路径生成位置，在计算总成本时加上指向相邻位置的代价。~~

问题2：DWA的传统安全距离(膨胀半径)是固定的，可能会丢失最优解

- ~~假设在动态障碍物速度已知的情况下，将速度信息(大小、方向)考虑进评价函数中~~

改进：

- [x] 假设动态障碍物速度已知的情况下，将动态障碍物的预测轨迹加入$dist()$函数。
- [x] 假设动态障碍物速度已知的情况下，增加$RO(v_r,v_o)$函数，判断机器人运动方向与障碍物运动方向。
- [ ] 不仅仅从机器人的当前位置生成路径，也从机器人的周围路径生成位置，在计算总成本时加上指向相邻位置的代价。

假设机器人所在点为$o$，障碍物所在点为$r$，目标点$g$，$\vec {ro}$相对于$\vec {rg}$的夹角$\theta_1$，$\boldsymbol {v_r}$相对于$\boldsymbol {v_o}$的夹角$\theta_2$。

将$\theta_1$从$0\degree \sim 360\degree$按$90\degree$间隔划分为四块，$\theta_2$同理：

<img src="https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/11/upgit_20221104_1667527868.png" alt="image-20221104101108409" style="zoom:80%;" />

<img src="https://raw.githubusercontent.com/simoonp/upgit_picture/main/2022/11/upgit_20221104_1667528047.png" alt="image-20221104101407422" style="zoom: 67%;" />

可能会发生碰撞的情况：

- 机器人和障碍物的速度夹角绝对值小于90°，且障碍物速度经过三角形区域，且障碍物速度在机器人速度方向上的分量大于机器人速度
- 障碍物速度经过三角形区域 && [(机器人和障碍物的速度夹角绝对值小于90° && 障碍物速度在机器人速度方向上的分量大于机器人速度) || (机器人和障碍物的速度夹角绝对值在90-180之间)] 

# conda

**环境配置**

```shell
#创建环境,指定python版本
conda create -n env_name python=3.x
#激活环境
conda activate env_name	# source activate env_name
#查看现有的环境
conda env list  # 或者 conda info --envs
#删除环境
conda remove -n env_name --all
# 退出当前环境
deactivate env_name

# 你的环境中用conda或者pip安装包
conda install 包名称
# 或者pip install 包名称 -i https://pypi.tuna.tsinghua.edu.cn/simple（清华镜像）
# 或者pip install 包名称 -i  https://pypi.doubanio.com/simple/ （豆瓣镜像）

# 查看环境中现有的包
conda list  # 或者 pip list

```



**打包环境：**

```shell
# 打包
conda pack -n name-of-env # 生成一个压缩文件 name-of-env.tar.gz

# 还原
cd path-of-anaconda3/envs
mkdir name-of-env
cd name-of-env
env_path=$(pwd)
cd path-of-name-of-env.tar.gz 
tar -xzvf name-of-env.tar.gz -C $env_path
conda info -e # 查看结果
conda activate name-of-env
```

