## 2022.01.09

### Docker学习

Docker的安装文档：https://docs.docker.com/get-started/

docker-ce 社区版docker

启动docker
> sudo systemctl start docker 

docker version 查看是否安装成功

测试hello world
> sudo docker run hello-world

查看已安装的镜像 
> docker images 

docker帮助命令
>docker version 显示docker的版本信息
>docker info    显示docker的系统信息，更详细 
>docker 命令 --help

docker的所有指令 https://docs.docker.com/reference/

## 镜像命令

docker images 查看所有镜像

```shell
root@tom:/home/tom# docker images
REPOSITORY           TAG       IMAGE ID       CREATED       SIZE
tensorflow/serving   1.13.1    a1e1ff37f1c7   2 years ago   206MB
tensorflow/serving   latest    048f8669e211   2 years ago   214MB
hello-world          latest    fce289e99eb9   3 years ago   1.84kB

# 解释
REPOSITORY  镜像的仓库源/名字
TAG         镜像的标签
IMAGE ID    镜像的id
CREATED     镜像创建的时间
SIZE        镜像的大小

# 可选项

    -a --all    #列出所有镜像
    -q --quiet  #只显示镜像的id

```
docker hub: https://hub.docker.com/

docker search 搜索命令

```shell
root@tom:/home/tom# docker search mysql
NAME                              DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED
mysql                             MySQL is a widely used, open-source relation…   11940     [OK]       
mariadb                           MariaDB Server is a high performing open sou…   4562      [OK]       
mysql/mysql-server                Optimized MySQL Server Docker images. Create…   896                  [OK]
phpmyadmin                        phpMyAdmin - A web interface for MySQL and M…   419       [OK]  

# 可选项，
 --filter=STARS=3000 #搜索收藏数不低于3000的镜像
```

docker pull 下载镜像
```shell
# docker pull 镜像名字[:tag]
root@tom:/home/tom# docker pull mysql   
Using default tag: latest   # 如果不写 tag，默认使 latest
latest: Pulling from library/mysql
72a69066d2fe: Pull complete     # 分层下载，docker image的核心，联合文件系统
93619dbc5b36: Pull complete 
99da31dd6142: Pull complete 
626033c43d70: Pull complete 
37d5d7efb64e: Pull complete 
ac563158d721: Pull complete 
d2ba16033dad: Pull complete 
688ba7d5c01a: Pull complete 
00e060b6d11d: Pull complete 
1c04857f594f: Pull complete 
4d7cfa90e6ea: Pull complete 
e0431212d27d: Pull complete 
Digest: sha256:e9027fe4d91c0153429607251656806cc784e914937271037f7738bd5b8e7709 # 签名
Status: Downloaded newer image for mysql:latest
docker.io/library/mysql:latest  # 真实地址
# docker pull mysql 等价于 docker pull docker.io/library/mysql:latest

# 指定版本下载
root@tom:/home/tom# docker pull mysql:5.7
5.7: Pulling from library/mysql
72a69066d2fe: Already exists 
93619dbc5b36: Already exists 
99da31dd6142: Already exists 
626033c43d70: Already exists 
37d5d7efb64e: Already exists 
ac563158d721: Already exists 
d2ba16033dad: Already exists 
0ceb82207cd7: Pull complete 
37f2405cae96: Pull complete 
e2482e017e53: Pull complete 
70deed891d42: Pull complete 
Digest: sha256:f2ad209efe9c67104167fc609cca6973c8422939491c9345270175a300419f94
Status: Downloaded newer image for mysql:5.7
docker.io/library/mysql:5.7
```

docker rmi 删除镜像
```shell
root@tom:/home/tom# docker rmi -f 镜像id # 删除指定的镜像
root@tom:/home/tom# docker rmi -f 镜像id1 镜像id2 镜像id3 # 删除多个镜像
root@tom:/home/tom# docker rmi -f $(docker images -aq) #删除全部指令，$(docker images -aq)可以搜索全部镜像的id
```
## 容器命令

有了镜像才能创建容器，以centos为例

```shell
docker pull centos 
root@tom:/home/tom# docker pull ubuntu
```
**新建容器并启动**
```shell
docker run [可选参数] imagesID

# 参数说明
--name="Name"   建立的容器的名字，用来区分容器
-d              后台运行方式
-it             使用交互方式运行，进入容器查看内容
-p              指定容器的端口 -p 8080:8080
    -p 主机端口：容器端口
    -p 容器端口
    容器端口
    -p ip:主机端口:容器端口
-P              随机指定端口

# 测试，启动并加入容器
root@tom:/home/tom# docker run -it ubuntu /bin/bash
root@531b74ff3ee5:/# ls # 查看容器内的文件
bin  boot  dev  etc  home  lib  lib32  lib64  libx32  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var 

# 从容器中退出
root@531b74ff3ee5:/# exit
exit

```

**列出所有运行的容器**
```shell
# docker ps 命令
    # 列出当前正在运行的容器
-a  # 列出当前正在运行的容器+历史运行过的容器
-n=?    #显示最近创建的？个容器
-q  # 只显示容器的编号

root@tom:/home/tom# docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES

root@tom:/home/tom# docker ps -a
CONTAINER ID   IMAGE                COMMAND                  CREATED         STATUS                          PORTS                              NAMES
531b74ff3ee5   ubuntu               "/bin/bash"              3 minutes ago   Exited (0) About a minute ago                                      angry_heisenberg
0483ac9695b9   hello-world          "/hello"                 17 hours ago    Exited (0) 17 hours ago                                            exciting_joliot
```
**退出容器**
```shell
exit    # 直接停止容器并退出
Ctrl+P+Q    #容器不停止，退出
```

**删除容器**
```shell
docker rm 容器id    # 删除指定容器，不能删除正在运行的容器，强制删除 -f
docker rm $(docker ps -aq)  # 删除所有容器
docker ps -a -q|xargs docker rm # 删除所有容器
```
**启动和停止容器**
```shell
docker start 容器id     # 启动
docker restart 容器id   # 重启
docker stop 容器id      # 停止
docker kill 容器id      # 强制停止容器
```

**常用的其他命令**

后台启动容器
```shell
# 命令 docker run -d 镜像名
root@tom:/home/tom# docker run -d ubuntu
# 问题：使用docker ps发现ubuntu停止了
# 常见的坑：docker容器使用后台运行，就必须有一个前台进程，docker发现没有应用，就会自动停止
```
**查看日志**
```shell
docker logs -f -t --tail 日志数量 容器id #没有日志
# 编写一个脚本，让容器一直运行
root@tom:/home/tom# docker run -d ubuntu /bin/sh -c "while true;do echo mmm;sleep 1;done"

root@tom:/home/tom# docker ps
CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS     NAMES
916d0f7cfe4b   ubuntu    "/bin/sh -c 'while t…"   5 seconds ago   Up 4 seconds             modest_moor

# 显示日志
    -t  #显示日志
    -f  #显示时间戳
    --tail number   # 显示日志条数
root@tom:/home/tom# docker logs -f -t --tail 10 916d0f7cfe4b
```

查看容器中进程的信息
```shell
# 命令 docker top 容器id
root@tom:/home/tom# docker top 916d0f7cfe4b
UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD
root                19243               19209               0                   15:59               ?                   00:00:00            /bin/sh -c while true;do echo mmm;sleep 1;done
root                19872               19243               0                   16:04               ?                   00:00:00            sleep 1
```
**查看镜像的源数据**
```shell
# 命令 docker inspect 容器id
root@tom:/home/tom# docker inspect 916d0f7cfe4b
[
    {
        "Id": "916d0f7cfe4be9ed294d4354057a58cef64481efd66ba9a176c38020f8aa3c9f",
        "Created": "2022-01-10T07:59:12.000439739Z",
        "Path": "/bin/sh",
        "Args": [
            "-c",
            "while true;do echo mmm;sleep 1;done"
        ],
        "State": {
            "Status": "running",
            "Running": true,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 19243,
            "ExitCode": 0,
            "Error": "",
            "StartedAt": "2022-01-10T07:59:12.718429414Z",
            "FinishedAt": "0001-01-01T00:00:00Z"
        },
        "Image": "sha256:d13c942271d66cb0954c3ba93e143cd253421fe0772b8bed32c4c0077a546d4d",
        "ResolvConfPath": "/var/lib/docker/containers/916d0f7cfe4be9ed294d4354057a58cef64481efd66ba9a176c38020f8aa3c9f/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/916d0f7cfe4be9ed294d4354057a58cef64481efd66ba9a176c38020f8aa3c9f/hostname",
        "HostsPath": "/var/lib/docker/containers/916d0f7cfe4be9ed294d4354057a58cef64481efd66ba9a176c38020f8aa3c9f/hosts",
        "LogPath": "/var/lib/docker/containers/916d0f7cfe4be9ed294d4354057a58cef64481efd66ba9a176c38020f8aa3c9f/916d0f7cfe4be9ed294d4354057a58cef64481efd66ba9a176c38020f8aa3c9f-json.log",
        "Name": "/modest_moore",
        "RestartCount": 0,
        "Driver": "overlay2",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "docker-default",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": null,
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "default",
            "PortBindings": {},
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "host",
            "Dns": [],
            "DnsOptions": [],
            "DnsSearch": [],
            "ExtraHosts": null,
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": false,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": null,
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "ConsoleSize": [
                0,
                0
            ],
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": [],
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": [],
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "KernelMemory": 0,
            "KernelMemoryTCP": 0,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": false,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": [
                "/proc/asound",
                "/proc/acpi",
                "/proc/kcore",
                "/proc/keys",
                "/proc/latency_stats",
                "/proc/timer_list",
                "/proc/timer_stats",
                "/proc/sched_debug",
                "/proc/scsi",
                "/sys/firmware"
            ],
            "ReadonlyPaths": [
                "/proc/bus",
                "/proc/fs",
                "/proc/irq",
                "/proc/sys",
                "/proc/sysrq-trigger"
            ]
        },
        "GraphDriver": {
            "Data": {
                "LowerDir": "/var/lib/docker/overlay2/75dff48ce7c9e6931a9733c98ce6159fbe69b8dffd26bee04127fd2c1e2e100a-init/diff:/var/lib/docker/overlay2/759ad84cabbef8506082a5afe831afe9a0e26eb5963fc2af151baf8bbc9c303a/diff",
                "MergedDir": "/var/lib/docker/overlay2/75dff48ce7c9e6931a9733c98ce6159fbe69b8dffd26bee04127fd2c1e2e100a/merged",
                "UpperDir": "/var/lib/docker/overlay2/75dff48ce7c9e6931a9733c98ce6159fbe69b8dffd26bee04127fd2c1e2e100a/diff",
                "WorkDir": "/var/lib/docker/overlay2/75dff48ce7c9e6931a9733c98ce6159fbe69b8dffd26bee04127fd2c1e2e100a/work"
            },
            "Name": "overlay2"
        },
        "Mounts": [],
        "Config": {
            "Hostname": "916d0f7cfe4b",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": false,
            "AttachStderr": false,
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
            ],
            "Cmd": [
                "/bin/sh",
                "-c",
                "while true;do echo mmm;sleep 1;done"
            ],
            "Image": "ubuntu",
            "Volumes": null,
            "WorkingDir": "",
            "Entrypoint": null,
            "OnBuild": null,
            "Labels": {}
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "24113e95cd028e73b5fc9c5db2ef90f457028a266a7d65e88b32b380c04207cb",
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "Ports": {},
            "SandboxKey": "/var/run/docker/netns/24113e95cd02",
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "90e95c1c96dd5667347fab3539e2f5809857d4d20fd6929a57e08e0e221f591e",
            "Gateway": "172.17.0.1",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "172.17.0.2",
            "IPPrefixLen": 16,
            "IPv6Gateway": "",
            "MacAddress": "02:42:ac:11:00:02",
            "Networks": {
                "bridge": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": null,
                    "NetworkID": "483469c75d25ed0a84ce31f95d0dab33abf88a4d30b01a73b15c10be58f949c7",
                    "EndpointID": "90e95c1c96dd5667347fab3539e2f5809857d4d20fd6929a57e08e0e221f591e",
                    "Gateway": "172.17.0.1",
                    "IPAddress": "172.17.0.2",
                    "IPPrefixLen": 16,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "MacAddress": "02:42:ac:11:00:02",
                    "DriverOpts": null
                }
            }
        }
    }
]
```

**进入正在运行的容器**

```shell
# 容器通常后台运行，需要进入容器修改配置
# 命令 
docker exec -it 容器id bashShell    # 开启一个新终端
# 测试
root@tom:/home/tom# docker ps
CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS     NAMES
916d0f7cfe4b   ubuntu    "/bin/sh -c 'while t…"   10 minutes ago   Up 10 minutes             modest_moore
root@tom:/home/tom# docker exec -it 916d0f7cfe4b /bin/bash
root@916d0f7cfe4b:/# ps -df
UID        PID  PPID  C STIME TTY          TIME CMD
root       674     1  0 08:10 ?        00:00:00 sleep 1
root       675   654  0 08:10 pts/0    00:00:00 ps -df
root@916d0f7cfe4b:/# ps -ef
UID        PID  PPID  C STIME TTY          TIME CMD
root         1     0  0 07:59 ?        00:00:00 /bin/sh -c while true;do echo mmm;sleep 1;done
root       654     0  0 08:09 pts/0    00:00:00 /bin/bash
root       679     1  0 08:10 ?        00:00:00 sleep 1
root       680   654  0 08:10 pts/0    00:00:00 ps -ef

# 方式二，进入正在运行的终端，不会启动新进程
docker attach 容器id
```
**从容器拷贝文件到主机**
```shell
docker cp 容器id:容器内文件的路径 主机文件夹路径

root@tom:/home/tom# docker ps
CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS     NAMES
916d0f7cfe4b   ubuntu    "/bin/sh -c 'while t…"   21 minutes ago   Up 21 minutes             modest_moore
root@tom:/home/tom# docker exec -it 916d0f7cfe4b /bin/bash
root@916d0f7cfe4b:/# cd /home
root@916d0f7cfe4b:/home# ls
root@916d0f7cfe4b:/home# touch test.cpp
root@916d0f7cfe4b:/home# exit
exit
root@tom:/home/tom# docker cp 916d0f7cfe4b:/home/test.cpp /home/tom/
root@tom:/home/tom# ls | grep test
opencvtest
test.cpp
test.yaml

# 拷贝是一个手动的过程，后期可以使用 -v 卷的技术，实现数据自动同步
```
**小结**

<img src="https://raw.githubusercontent.com/simoonp/picture/main/docker/docker.jpg" alt="Image" style="zoom:100%;" />

> 作业1 docker安装nginx

```shell
# 1、搜索镜像 search，可以去docker hub上搜索
# 2、下载镜像 pull
# 3、运行测试

# -d 后台运行
# --name 容器命名
# -p 服务器/宿主机端口:容器内部端口 映射端口
root@tom:/home/tom# docker run -d --name nginx01 -p 3344:80 nginx
4c8887c9b9013d7f18f0fc8e05aeeaee3ac6d7516f066331915f5604c0682653
root@tom:/home/tom# docker ps
CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS                                   NAMES
4c8887c9b901   nginx     "/docker-entrypoint.…"   7 seconds ago   Up 6 seconds   0.0.0.0:3344->80/tcp, :::3344->80/tcp   nginx01
916d0f7cfe4b   ubuntu    "/bin/sh -c 'while t…"   3 hours ago     Up 3 hours                                             modest_moore
```

> 作业2 docker安装tomcat
```shell
# 官方的使用
docker run -it --rm tomcat:9.0
# --rm 参数 在容器运行完后会自动删除
# 当停掉tomcat后，容器就没了

docker pull tomcat:9.0

docker run -d -p 3355:8080 --name tomcat01 tomcat
# 访问没有问题，但没有内容，但官方下载的是阉割版本的
```
![Images](https://raw.githubusercontent.com/simoonp/picture/main/docker/tomcat01.png)
```shell
# 从终端进入tomcat01
root@tom:/home/tom# docker exec -it tomcat01 /bin/bash
root@e0335f9ea8b6:/usr/local/tomcat# cd /usr/local/tomcat/webapps
root@e0335f9ea8b6:/usr/local/tomcat/webapps# ls
root@e0335f9ea8b6:/usr/local/tomcat/webapps# 
# 问题1：Linux命令少了
# 问题2：没有webapps
# 默认是最小镜像，阉割了好多东西，webapps文件夹里的东西在webapps.list里面
```

> 作业3 部署es + kibana

```shell
# es 暴漏的端口多；十分耗内存；数据一般需要放置到安全目录，要挂载
# https://hub.docker.com/_/elasticsearch
$ docker run -d --name elasticsearch --net somenetwork -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" elasticsearch:tag
# --net somenetwork 是网络配置，暂时不用
$ docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" elasticsearch:7.16.2

# 很占内存！！！ docker stats 查看CPU的状态，占了8G的内存
CONTAINER ID   NAME            CPU %     MEM USAGE / LIMIT     MEM %     NET I/O           BLOCK I/O        PIDS
4655ddc8dcb5   elasticsearch   1.22%     8.366GiB / 15.61GiB   53.60%    22.3kB / 1.98kB   85.7MB / 778kB   89
e0335f9ea8b6   tomcat01        0.13%     240MiB / 15.61GiB     1.50%     170kB / 126kB     340kB / 0B       43
4c8887c9b901   nginx01         0.00%     28.67MiB / 15.61GiB   0.18%     267kB / 3.68kB    0B / 8.19kB      33
916d0f7cfe4b   modest_moore    0.16%     9.629MiB / 15.61GiB   0.06%     348kB / 0B        193kB / 0B       2

# 访问测试
root@tom:/home/tom# curl localhost:9200
{
  "name" : "4655ddc8dcb5",
  "cluster_name" : "docker-cluster",
  "cluster_uuid" : "v9Dd4MNZTU-YA1SmmGGq-w",
  "version" : {
    "number" : "7.16.2",
    "build_flavor" : "default",
    "build_type" : "docker",
    "build_hash" : "2b937c44140b6559905130a8650c64dbd0879cfb",
    "build_date" : "2021-12-18T19:42:46.604893745Z",
    "build_snapshot" : false,
    "lucene_version" : "8.10.1",
    "minimum_wire_compatibility_version" : "6.8.0",
    "minimum_index_compatibility_version" : "6.0.0-beta1"
  },
  "tagline" : "You Know, for Search"
}

# 关闭 es
root@tom:/home/tom# docker stop 4655ddc8dcb5

# 新建容器，增加内存限制，修改配置文件， -e 参数 环境配置修改
$ docker run -d --name elasticsearch02 -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" -e ES_JAVA_OPTS="-Xms64m -Xmx512m" elasticsearch:7.16.2

CONTAINER ID   NAME              CPU %     MEM USAGE / LIMIT     MEM %     NET I/O          BLOCK I/O       PIDS
7fe1e4e51920   elasticsearch02   53.84%    562.4MiB / 15.61GiB   3.52%     7.63MB / 122kB   15.4MB / 16MB   101
e0335f9ea8b6   tomcat01          0.15%     240.1MiB / 15.61GiB   1.50%     208kB / 126kB    422kB / 0B      43
4c8887c9b901   nginx01           0.00%     28.67MiB / 15.61GiB   0.18%     304kB / 3.68kB   0B / 8.19kB     33
916d0f7cfe4b   modest_moore      0.18%     9.672MiB / 15.61GiB   0.06%     385kB / 0B       193kB / 0B      2
```

**可视化**

- portainer
```shell
docker run -d -p 8088:9000 --restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer
```
- Rancher(CI/CD再用)

**什么是portainer？**

Docker图形化管理界面！提供一个后台面板
```shell
root@tom:/home/tom# docker run -d -p 8088:9000 --restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer

root@tom:/home/tom# docker ps
CONTAINER ID   IMAGE                  COMMAND                  CREATED             STATUS             PORTS                                                                                  NAMES
2b65a0ca08fe   portainer/portainer    "/portainer"             31 seconds ago      Up 30 seconds      0.0.0.0:8088->9000/tcp, :::8088->9000/tcp                                              inspiring_swirles
7fe1e4e51920   elasticsearch:7.16.2   "/bin/tini -- /usr/l…"   12 minutes ago      Up 12 minutes      0.0.0.0:9200->9200/tcp, :::9200->9200/tcp, 0.0.0.0:9300->9300/tcp, :::9300->9300/tcp   elasticsearch02
e0335f9ea8b6   tomcat                 "catalina.sh run"        51 minutes ago      Up 51 minutes      0.0.0.0:3355->8080/tcp, :::3355->8080/tcp                                              tomcat01
4c8887c9b901   nginx                  "/docker-entrypoint.…"   About an hour ago   Up About an hour   0.0.0.0:3344->80/tcp, :::3344->80/tcp                                                  nginx01
916d0f7cfe4b   ubuntu                 "/bin/sh -c 'while t…"   4 hours ago         Up 4 hours                                                                                                modest_moore

```
测试：访问8088

![Images](https://raw.githubusercontent.com/simoonp/picture/main/docker/portainer.png)

![Images](https://raw.githubusercontent.com/simoonp/picture/main/docker/portainer02.png)

## commit镜像

```shell
docker commit 提交容器成为一个新的副本

# 与git命令类似
docker commit -m="提交的描述信息" -a="作者名" 容器ID 目标镜像名:[tag]
```

实战测试
```shell
# 之前的tomcat已经移动过文件了，把这个容器做成镜像
root@tom:/home/tom# docker commit -a="Simoonp" -m="tomcat commit test" e0335f9ea8b6 tomcat02:1.0
sha256:b3272ce7d6f23a950a96d4ab758f8e39dea4d03b1162368772a84db041d925bc
root@tom:/home/tom# docker images
REPOSITORY            TAG       IMAGE ID       CREATED         SIZE
tomcat02              1.0       b3272ce7d6f2   6 seconds ago   684MB
ubuntu                latest    d13c942271d6   3 days ago      72.8MB
nginx                 latest    605c77e624dd   11 days ago     141MB
tomcat                9.0       b8e65a4d736d   2 weeks ago     680MB
tomcat                latest    fb5657adc892   2 weeks ago     680MB
mysql                 latest    3218b38490ce   2 weeks ago     516MB
elasticsearch         7.16.2    66c29cde15ce   3 weeks ago     646MB
centos                latest    5d0da3dc9764   3 months ago    231MB
# 以后就可以使用自己修改的镜像
```
---
## 2021.01.10

### 容器数据卷


### DockerFile


### Docker网络